class Searcher{constructor(e,t){this.database=t.database||{},this.SHOW_NUM=t.SHOW_NUM||40,this.href_key=t.href_key||null,this.updateDatabase(this.database),this.initializeDOM(e),this.createEventListener()}initializeDOM(e){this.dom={},this.dom.parent=e,this.dom.parent.classList.add("app"),this.dom.container=this.createAndAppendElement(e,"div",{class:"searcher-container"}),this.dom.seacher=this.createAndAppendElement(this.dom.container,"div",{class:"searcher"}),this.dom.input=this.createAndAppendElement(this.dom.seacher,"input",{class:"searcher-input",placeholder:"keywords..."}),this.dom.cardsContainer=this.createAndAppendElement(this.dom.container,"div",{class:"cards-container"}),this.dom.input.focus()}updateDatabase(e){this.database=e,this.TOTAL_NUM=Object.keys(this.database).length}addMark(e,t){t=new RegExp(t,"gi");return(e=e.replace(/(<mark>|<\/mark>)/gim,"")).replace(t,"<mark>$&</mark>")}createCard(e,t,a=null){var s=t.k.join("/");let r;r=this.href_key&&t[this.href_key]||"#";var e=this.createAndAppendElement(e,"a",{class:"card",href:r}),i=this.createAndAppendElement(e,"div",{class:"card-container"}),t=this.createAndAppendElement(i,"h4",{class:"card-title",innerText:""+t.n}),i=this.createAndAppendElement(i,"p",{class:"card-keys",innerText:""+s});return a&&(t.innerHTML=this.addMark(t.innerHTML,a),i.innerHTML=this.addMark(i.innerHTML,a)),e}createAndAppendElement(e,t,a={}){const s=document.createElement(t);return a.class&&(a.class.split(" ").forEach(e=>s.classList.add(e)),delete a.class),a.dataset&&(Object.keys(a.dataset).forEach(e=>s.dataset[e]=a.dataset[e]),delete a.dataset),Object.keys(a).forEach(e=>s[e]=a[e]),e.appendChild(s),s}search(e){var t=e.target.value.trim();if(t){var a,s=document.createDocumentFragment(),r=1;for(a of Object.values(this.database))if(this.parseKeyword(t,a)&&(this.createCard(s,a,t),++r>=this.SHOW_NUM))break;this.dom.cardsContainer.innerHTML="",this.dom.cardsContainer.appendChild(s)}else this.dom.cardsContainer.innerHTML=""}createEventListener(){this.dom.input&&this.search&&(this.search=this.search.bind(this),this.dom.input.addEventListener("input",this.search))}parseKeyword(e,t){var a,e=e.toLowerCase().split(","),s=e[0],e=(e[1],t.n||""),t=t.k||[];if(e.toLowerCase().includes(s))return!0;for(a of t)if(a.toLowerCase().includes(s))return!0;return!1}}window.Searcher=Searcher;